!function(){"use strict";function e(e){return{request:function(a){var o=e.get("token");if(o){var u={},i=new jsSHA("SHA-512","TEXT");i.setHMACKey(o,"TEXT"),n(a.params)||(u=r(a.params)),n(a.data)||(u=r(a.data)),u.token=o,u.timestamp=Math.round(+new Date/1e3).toString(),u["client-nonce"]=t(32),u.url=a.url,i.update(JSON.stringify(u)),a.headers["access-token"]=u.token,a.headers.timestamp=u.timestamp,a.headers["client-nonce"]=u["client-nonce"],a.headers.url=u.url,a.headers.hash=i.getHMAC("HEX")}return a}}}function n(e){return angular.isUndefined(e)||null===e}function r(e){var n={};Object.keys(e);return Object.keys(e).forEach(function(r){n[r]=e[r].toString()}),n}function t(e,n){n=n||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var r="",t=0;t<e;t++){var a=Math.floor(Math.random()*n.length);r+=n.substring(a,a+1)}return r}angular.module("linkthrow.hmacPacketAuth").factory("AddAccessTokenHeaderInterceptor",e)}(),function(){"use strict";angular.module("linkthrow.hmacPacketAuth",[])}(),function(e){function n(e,n,r){var t,a,o,u,b,l,p,d,A=0,g=[],E=0,v=!1,m=[],H=[],k=!1;if(r=r||{},t=r.encoding||"UTF8",d=r.numRounds||1,o=h(n,t),d!==parseInt(d,10)||1>d)throw Error("numRounds must a integer >= 1");if(l=function(n,r){return y(n,r,e)},p=function(n,r,t,a){var o,u;if("SHA-384"!==e&&"SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");for(o=(r+129>>>10<<5)+31,u=32;n.length<=o;)n.push(0);for(n[r>>>5]|=128<<24-r%32,r+=t,n[o]=4294967295&r,n[o-1]=r/4294967296|0,t=n.length,r=0;r<t;r+=u)a=y(n.slice(r,r+u),a,e);if("SHA-384"===e)n=[a[0].a,a[0].b,a[1].a,a[1].b,a[2].a,a[2].b,a[3].a,a[3].b,a[4].a,a[4].b,a[5].a,a[5].b];else{if("SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");n=[a[0].a,a[0].b,a[1].a,a[1].b,a[2].a,a[2].b,a[3].a,a[3].b,a[4].a,a[4].b,a[5].a,a[5].b,a[6].a,a[6].b,a[7].a,a[7].b]}return n},"SHA-384"===e)b=1024,u=384;else{if("SHA-512"!==e)throw Error("Chosen SHA variant is not supported");b=1024,u=512}a=U(e),this.setHMACKey=function(n,r,o){var u;if(!0===v)throw Error("HMAC key already set");if(!0===k)throw Error("Cannot set HMAC key after calling update");if(t=(o||{}).encoding||"UTF8",r=h(r,t)(n),n=r.binLen,r=r.value,u=b>>>3,o=u/4-1,u<n/8){for(r=p(r,n,0,U(e));r.length<=o;)r.push(0);r[o]&=4294967040}else if(u>n/8){for(;r.length<=o;)r.push(0);r[o]&=4294967040}for(n=0;n<=o;n+=1)m[n]=909522486^r[n],H[n]=1549556828^r[n];a=l(m,a),A=b,v=!0},this.update=function(e){var n,r,t,u=0,i=b>>>5;for(n=o(e,g,E),e=n.binLen,r=n.value,n=e>>>5,t=0;t<n;t+=i)u+b<=e&&(a=l(r.slice(t,t+i),a),u+=b);A+=u,g=r.slice(u>>>5),E=e%b,k=!0},this.getHash=function(n,r){var t,o,h,b;if(!0===v)throw Error("Cannot call getHash after setting HMAC key");switch(h=c(r),n){case"HEX":t=function(e){return i(e,h)};break;case"B64":t=function(e){return w(e,h)};break;case"BYTES":t=f;break;case"ARRAYBUFFER":try{o=new ArrayBuffer(0)}catch(l){throw Error("ARRAYBUFFER not supported by this environment")}t=s;break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(b=p(g.slice(),E,A,a.slice()),o=1;o<d;o+=1)b=p(b,u,0,U(e));return t(b)},this.getHMAC=function(n,r){var t,o,h,d;if(!1===v)throw Error("Cannot call getHMAC without first setting HMAC key");switch(h=c(r),n){case"HEX":t=function(e){return i(e,h)};break;case"B64":t=function(e){return w(e,h)};break;case"BYTES":t=f;break;case"ARRAYBUFFER":try{t=new ArrayBuffer(0)}catch(m){throw Error("ARRAYBUFFER not supported by this environment")}t=s;break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return o=p(g.slice(),E,A,a.slice()),d=l(H,U(e)),d=p(o,u,b,d),t(d)}}function r(e,n){this.a=e,this.b=n}function t(e,n,r){var t,a,o,u,i,w=e.length;if(n=n||[0],r=r||0,i=r>>>3,0!==w%2)throw Error("String of HEX type must be in byte increments");for(t=0;t<w;t+=2){if(a=parseInt(e.substr(t,2),16),isNaN(a))throw Error("String of HEX type contains invalid characters");for(u=(t>>>1)+i,o=u>>>2;n.length<=o;)n.push(0);n[o]|=a<<8*(3-u%4)}return{value:n,binLen:4*w+r}}function a(e,n,r){var t,a,o,u,i=[],i=n||[0];for(r=r||0,a=r>>>3,t=0;t<e.length;t+=1)n=e.charCodeAt(t),u=t+a,o=u>>>2,i.length<=o&&i.push(0),i[o]|=n<<8*(3-u%4);return{value:i,binLen:8*e.length+r}}function o(e,n,r){var t,a,o,u,i,w,f=[],s=0,f=n||[0];if(r=r||0,n=r>>>3,-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(a=e.indexOf("="),e=e.replace(/\=/g,""),-1!==a&&a<e.length)throw Error("Invalid '=' found in base-64 string");for(a=0;a<e.length;a+=4){for(i=e.substr(a,4),o=u=0;o<i.length;o+=1)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(i[o]),u|=t<<18-6*o;for(o=0;o<i.length-1;o+=1){for(w=s+n,t=w>>>2;f.length<=t;)f.push(0);f[t]|=(u>>>16-8*o&255)<<8*(3-w%4),s+=1}}return{value:f,binLen:8*s+r}}function u(e,n,r){var t,a,o,u=[],u=n||[0];for(r=r||0,t=r>>>3,n=0;n<e.byteLength;n+=1)o=n+t,a=o>>>2,u.length<=a&&u.push(0),u[a]|=e[n]<<8*(3-o%4);return{value:u,binLen:8*e.byteLength+r}}function i(e,n){var r,t,a="",o=4*e.length;for(r=0;r<o;r+=1)t=e[r>>>2]>>>8*(3-r%4),a+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return n.outputUpper?a.toUpperCase():a}function w(e,n){var r,t,a,o="",u=4*e.length;for(r=0;r<u;r+=3)for(a=r+1>>>2,t=e.length<=a?0:e[a],a=r+2>>>2,a=e.length<=a?0:e[a],a=(e[r>>>2]>>>8*(3-r%4)&255)<<16|(t>>>8*(3-(r+1)%4)&255)<<8|a>>>8*(3-(r+2)%4)&255,t=0;4>t;t+=1)o+=8*r+6*t<=32*e.length?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>6*(3-t)&63):n.b64Pad;return o}function f(e){var n,r,t="",a=4*e.length;for(n=0;n<a;n+=1)r=e[n>>>2]>>>8*(3-n%4)&255,t+=String.fromCharCode(r);return t}function s(e){var n,r=4*e.length,t=new ArrayBuffer(r);for(n=0;n<r;n+=1)t[n]=e[n>>>2]>>>8*(3-n%4)&255;return t}function c(e){var n={outputUpper:!1,b64Pad:"="};if(e=e||{},n.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(n.b64Pad=e.b64Pad),"boolean"!=typeof n.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof n.b64Pad)throw Error("Invalid b64Pad formatting option");return n}function h(e,n){var r;switch(n){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":r=t;break;case"TEXT":r=function(e,r,t){var a,o,u,i,w,f=[],s=[],c=0,f=r||[0];if(r=t||0,u=r>>>3,"UTF8"===n)for(a=0;a<e.length;a+=1)for(t=e.charCodeAt(a),s=[],128>t?s.push(t):2048>t?(s.push(192|t>>>6),s.push(128|63&t)):55296>t||57344<=t?s.push(224|t>>>12,128|t>>>6&63,128|63&t):(a+=1,t=65536+((1023&t)<<10|1023&e.charCodeAt(a)),s.push(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)),o=0;o<s.length;o+=1){for(w=c+u,i=w>>>2;f.length<=i;)f.push(0);f[i]|=s[o]<<8*(3-w%4),c+=1}else if("UTF16BE"===n||"UTF16LE"===n)for(a=0;a<e.length;a+=1){for(t=e.charCodeAt(a),"UTF16LE"===n&&(o=255&t,t=o<<8|t>>>8),w=c+u,i=w>>>2;f.length<=i;)f.push(0);f[i]|=t<<8*(2-w%4),c+=2}return{value:f,binLen:8*c+r}};break;case"B64":r=o;break;case"BYTES":r=a;break;case"ARRAYBUFFER":try{r=new ArrayBuffer(0)}catch(i){throw Error("ARRAYBUFFER not supported by this environment")}r=u;break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return r}function b(e,n){var t=null,t=new r(e.a,e.b);return t=32>=n?new r(t.a>>>n|t.b<<32-n&4294967295,t.b>>>n|t.a<<32-n&4294967295):new r(t.b>>>n-32|t.a<<64-n&4294967295,t.a>>>n-32|t.b<<64-n&4294967295)}function l(e,n){var t=null;return t=32>=n?new r(e.a>>>n,e.b>>>n|e.a<<32-n&4294967295):new r(0,e.a>>>n-32)}function p(e,n,t){return new r(e.a&n.a^~e.a&t.a,e.b&n.b^~e.b&t.b)}function d(e,n,t){return new r(e.a&n.a^e.a&t.a^n.a&t.a,e.b&n.b^e.b&t.b^n.b&t.b)}function A(e){var n=b(e,28),t=b(e,34);return e=b(e,39),new r(n.a^t.a^e.a,n.b^t.b^e.b)}function g(e){var n=b(e,14),t=b(e,18);return e=b(e,41),new r(n.a^t.a^e.a,n.b^t.b^e.b)}function E(e){var n=b(e,1),t=b(e,8);return e=l(e,7),new r(n.a^t.a^e.a,n.b^t.b^e.b)}function v(e){var n=b(e,19),t=b(e,61);return e=l(e,6),new r(n.a^t.a^e.a,n.b^t.b^e.b)}function m(e,n){var t,a,o;return t=(65535&e.b)+(65535&n.b),a=(e.b>>>16)+(n.b>>>16)+(t>>>16),o=(65535&a)<<16|65535&t,t=(65535&e.a)+(65535&n.a)+(a>>>16),a=(e.a>>>16)+(n.a>>>16)+(t>>>16),new r((65535&a)<<16|65535&t,o)}function H(e,n,t,a){var o,u,i;return o=(65535&e.b)+(65535&n.b)+(65535&t.b)+(65535&a.b),u=(e.b>>>16)+(n.b>>>16)+(t.b>>>16)+(a.b>>>16)+(o>>>16),i=(65535&u)<<16|65535&o,o=(65535&e.a)+(65535&n.a)+(65535&t.a)+(65535&a.a)+(u>>>16),u=(e.a>>>16)+(n.a>>>16)+(t.a>>>16)+(a.a>>>16)+(o>>>16),new r((65535&u)<<16|65535&o,i)}function k(e,n,t,a,o){var u,i,w;return u=(65535&e.b)+(65535&n.b)+(65535&t.b)+(65535&a.b)+(65535&o.b),i=(e.b>>>16)+(n.b>>>16)+(t.b>>>16)+(a.b>>>16)+(o.b>>>16)+(u>>>16),w=(65535&i)<<16|65535&u,u=(65535&e.a)+(65535&n.a)+(65535&t.a)+(65535&a.a)+(65535&o.a)+(i>>>16),i=(e.a>>>16)+(n.a>>>16)+(t.a>>>16)+(a.a>>>16)+(o.a>>>16)+(u>>>16),new r((65535&i)<<16|65535&u,w)}function U(e){var n,t;switch(n=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e){case"SHA-224":e=n;break;case"SHA-256":e=t;break;case"SHA-384":e=[new r(3418070365,n[0]),new r(1654270250,n[1]),new r(2438529370,n[2]),new r(355462360,n[3]),new r(1731405415,n[4]),new r(41048885895,n[5]),new r(3675008525,n[6]),new r(1203062813,n[7])];break;case"SHA-512":e=[new r(t[0],4089235720),new r(t[1],2227873595),new r(t[2],4271175723),new r(t[3],1595750129),new r(t[4],2917565137),new r(t[5],725511199),new r(t[6],4215389547),new r(t[7],327033209)];break;default:throw Error("Unknown SHA variant")}return e}function y(e,n,t){var a,o,u,i,w,f,s,c,h,b,l,U,y,S,R,B,T,C,Y,L,X,M,x,P=[];if("SHA-384"!==t&&"SHA-512"!==t)throw Error("Unexpected error in SHA-2 implementation");for(b=80,U=2,M=r,y=m,S=H,R=k,B=E,T=v,C=A,Y=g,X=d,L=p,x=F,t=n[0],a=n[1],o=n[2],u=n[3],i=n[4],w=n[5],f=n[6],s=n[7],l=0;l<b;l+=1)16>l?(h=l*U,c=e.length<=h?0:e[h],h=e.length<=h+1?0:e[h+1],P[l]=new M(c,h)):P[l]=S(T(P[l-2]),P[l-7],B(P[l-15]),P[l-16]),c=R(s,Y(i),L(i,w,f),x[l],P[l]),h=y(C(t),X(t,a,o)),s=f,f=w,w=i,i=y(u,c),u=o,o=a,a=t,t=y(c,h);return n[0]=y(t,n[0]),n[1]=y(a,n[1]),n[2]=y(o,n[2]),n[3]=y(u,n[3]),n[4]=y(i,n[4]),n[5]=y(w,n[5]),n[6]=y(f,n[6]),n[7]=y(s,n[7]),n}var S,F;S=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],F=[new r(S[0],3609767458),new r(S[1],602891725),new r(S[2],3964484399),new r(S[3],2173295548),new r(S[4],4081628472),new r(S[5],3053834265),new r(S[6],2937671579),new r(S[7],3664609560),new r(S[8],2734883394),new r(S[9],1164996542),new r(S[10],1323610764),new r(S[11],3590304994),new r(S[12],4068182383),new r(S[13],991336113),new r(S[14],633803317),new r(S[15],3479774868),new r(S[16],2666613458),new r(S[17],944711139),new r(S[18],2341262773),new r(S[19],2007800933),new r(S[20],1495990901),new r(S[21],1856431235),new r(S[22],3175218132),new r(S[23],2198950837),new r(S[24],3999719339),new r(S[25],766784016),new r(S[26],2566594879),new r(S[27],3203337956),new r(S[28],1034457026),new r(S[29],2466948901),new r(S[30],3758326383),new r(S[31],168717936),new r(S[32],1188179964),new r(S[33],1546045734),new r(S[34],1522805485),new r(S[35],2643833823),new r(S[36],2343527390),new r(S[37],1014477480),new r(S[38],1206759142),new r(S[39],344077627),new r(S[40],1290863460),new r(S[41],3158454273),new r(S[42],3505952657),new r(S[43],106217008),new r(S[44],3606008344),new r(S[45],1432725776),new r(S[46],1467031594),new r(S[47],851169720),new r(S[48],3100823752),new r(S[49],1363258195),new r(S[50],3750685593),new r(S[51],3785050280),new r(S[52],3318307427),new r(S[53],3812723403),new r(S[54],2003034995),new r(S[55],3602036899),new r(S[56],1575990012),new r(S[57],1125592928),new r(S[58],2716904306),new r(S[59],442776044),new r(S[60],593698344),new r(S[61],3733110249),new r(S[62],2999351573),new r(S[63],3815920427),new r(3391569614,3928383900),new r(3515267271,566280711),new r(3940187606,3454069534),new r(4118630271,4000239992),new r(116418474,1914138554),new r(174292421,2731055270),new r(289380356,3203993006),new r(460393269,320620315),new r(685471733,587496836),new r(852142971,1086792851),new r(1017036298,365543100),new r(1126000580,2618297676),new r(1288033470,3409855158),new r(1501505948,4234509866),new r(1607167915,987167468),new r(1816402316,1246189591)],"function"==typeof define&&define.amd?define(function(){return n}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=exports=n:exports=n:e.jsSHA=n}(this);